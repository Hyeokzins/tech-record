# 2025-06-26 - ì¼ì¼ ê¸°ë¡

##  ì£¼ìš” ì—…ë¬´ ë° ì‘ì—…
- cctv í”„ë ˆì„ ë¶„ë¦¬,ë¼ë²¨ë§,ê°ì²´ì¸ì‹ ëª¨ë¸ í•™ìŠµ

##  ë°°ìš´ ì  ë° ì¸ì‚¬ì´íŠ¸
- ì‚¬ì „ì— í•™ìŠµí•œ ëª¨ë¸ì´ ê²€ì¶œí•œ ê°ì²´ë¥¼ ë¼ë²¨ë§ì— ì‚¬ìš©í•˜ëŠ” ë°©ì‹ì„ ì´ìš©í•´ ë¼ë²¨ë§ ê³¼ì •ì„ ë‹¨ì¶•í•  ìˆ˜ ìˆìŒ  
- ë‹¨ ì–´ëŠ ì •ë„ëŠ” ì§ì ‘ ì œì‘í•œ ë¼ë²¨ë§ íŒŒì¼ì€ ìˆì–´ì•¼í•¨ 
##  ì˜¤í†  ë¼ë²¨ë§
### autolabeling.py:
```python
# ì—¬ê¸°ì— ì‹¤ì œë¡œ ì‘ì„±í•œ íŒŒì´ì¬ ì½”ë“œ ì‚½ì…
import torch
import os
from pathlib import Path
from PIL import Image

# ========== ì„¤ì • ë¶€ë¶„ (ì—¬ê¸°ë§Œ ìˆ˜ì •í•˜ì„¸ìš”) ==========
MODEL_PATH =  
IMAGE_FOLDER =           
OUTPUT_FOLDER =          
CONFIDENCE = 0.7                    # ì‹ ë¢°ë„ (0.5~0.9)
# ===============================================

def auto_label_images():
    """ì´ë¯¸ì§€ë¥¼ ìë™ìœ¼ë¡œ ë¼ë²¨ë§í•˜ëŠ” í•¨ìˆ˜"""
    
    # ì¶œë ¥ í´ë” ìƒì„±
    os.makedirs(OUTPUT_FOLDER, exist_ok=True)
    
    # ëª¨ë¸ ë¡œë“œ
    print(f"ëª¨ë¸ ë¡œë”©: {MODEL_PATH}")
    try:
        model = torch.hub.load('ultralytics/yolov5', 'custom', path=MODEL_PATH)
        model.conf = CONFIDENCE
        print(f" ëª¨ë¸ ë¡œë“œ ì™„ë£Œ (ì‹ ë¢°ë„: {CONFIDENCE})")
    except Exception as e:
        print(f" ëª¨ë¸ ë¡œë“œ ì‹¤íŒ¨: {e}")
        return
    
    # ì´ë¯¸ì§€ íŒŒì¼ ì°¾ê¸°
    image_extensions = ['.jpg', '.jpeg', '.png', '.bmp']
    image_files = []
    
    for ext in image_extensions:
        image_files.extend(Path(IMAGE_FOLDER).glob(f"*{ext}"))
        image_files.extend(Path(IMAGE_FOLDER).glob(f"*{ext.upper()}"))
    
    if not image_files:
        print(f" {IMAGE_FOLDER} í´ë”ì—ì„œ ì´ë¯¸ì§€ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤!")
        return
    
    print(f"ğŸ“¸ ì²˜ë¦¬í•  ì´ë¯¸ì§€: {len(image_files)}ê°œ")
    
    # ì´ë¯¸ì§€ë³„ë¡œ ì²˜ë¦¬
    success_count = 0
    
    for i, img_path in enumerate(image_files, 1):
        try:
            # ì˜ˆì¸¡ ì‹¤í–‰
            results = model(str(img_path))
            detections = results.pandas().xyxy[0]
            
            if len(detections) > 0:
                # ë¼ë²¨ íŒŒì¼ ì €ì¥
                save_yolo_label(img_path, detections)
                success_count += 1
                print(f"[{i}/{len(image_files)}]  {img_path.name}: {len(detections)}ê°œ ê°ì²´")
            else:
                print(f"[{i}/{len(image_files)}]  {img_path.name}: ê°ì²´ ì—†ìŒ")
                
        except Exception as e:
            print(f"[{i}/{len(image_files)}]  {img_path.name}: ì˜¤ë¥˜ - {e}")
    
    print(f"\n ì™„ë£Œ {success_count}ê°œ ë¼ë²¨ íŒŒì¼ ìƒì„±ë¨")
    print(f" ë¼ë²¨ ì €ì¥ ìœ„ì¹˜: {OUTPUT_FOLDER}")

def save_yolo_label(image_path, detections):
    """YOLO í˜•ì‹ìœ¼ë¡œ ë¼ë²¨ ì €ì¥"""
    
    # ì´ë¯¸ì§€ í¬ê¸° ê°€ì ¸ì˜¤ê¸°
    img = Image.open(image_path)
    img_width, img_height = img.size
    
    # ë¼ë²¨ íŒŒì¼ ê²½ë¡œ
    label_file = Path(OUTPUT_FOLDER) / f"{image_path.stem}.txt"
    
    # ë¼ë²¨ ì €ì¥
    with open(label_file, 'w') as f:
        for _, detection in detections.iterrows():
            # ì¤‘ì‹¬ì ê³¼ í¬ê¸° ê³„ì‚° (0~1ë¡œ ì •ê·œí™”)
            x_center = (detection['xmin'] + detection['xmax']) / 2 / img_width
            y_center = (detection['ymin'] + detection['ymax']) / 2 / img_height
            width = (detection['xmax'] - detection['xmin']) / img_width
            height = (detection['ymax'] - detection['ymin']) / img_height
            
            class_id = int(detection['class'])
            
            # YOLO í˜•ì‹ìœ¼ë¡œ ì €ì¥
            f.write(f"{class_id} {x_center:.6f} {y_center:.6f} {width:.6f} {height:.6f}\n")

# ì‹¤í–‰
if __name__ == "__main__":
    auto_label_images()


```


##  ë‚´ì¼ í•  ì¼
- ì˜ìƒì²˜ë¦¬: ë¬¸ ì—´ë¦¼ ì¸ì‹
