# 2025-11-17 (월) - 일일 수행 내역

## 주요 업무 및 작업

### 객체 검출 모델 성능 개선 - 밝기 보정 실험

**문제 인식**
- 통합 CCTV 영상에서 전체 영역 밝기 보정 시 효과 미미
- 원인: 밝은 영역과 어두운 영역이 혼재하여 히스토그램 평활화 효과 감소

**실험 진행**
- 4개 카메라 영상을 개별 영역으로 분리하여 각각 밝기 보정 적용
- 특정 어두운 영역(차량 후면부)만 선택적 보정 테스트
- 전체 영역 보정 vs 부분 영역 보정 비교

**실험 결과**
1. 부분 영역만 보정: 대상 영역은 개선되나 주변 밝은 영역에서 그래픽 아티팩트 발생
2. 전체 영역 보정: 자연스러운 결과, 아티팩트 없음
3. 모델 인식률 비교 (conf=0.4 기준):
   - 밝기 보정 전후로 미세한 차이 확인
   - 학습 데이터 포함 여부에 따라 성능 차이 존재

**결론 및 향후 방향**
- 밝기 보정이 인식률 개선에 일정 부분 기여 확인
- 향후 학습 데이터 생성 시 밝기 보정 적용 후 라벨링 진행
- 라벨링 기준: "사람이 적당히 인식 가능한 수준"으로 완화 (기존: 극한 인식 수준)

---

## 배운 점 및 인사이트

### 히스토그램 평활화의 영역 의존성
- 보정 영역 크기와 밝기 분포에 따라 결과가 크게 달라짐
- 전체 화면에 밝은 영역이 포함되면 어두운 부분의 개선 효과 감소
- **정리:** 히스토그램 평활화는 선택 영역 내의 상대적 밝기 분포를 재배치하는 방식이므로 각 화면 별로 적용해야


### 라벨링 기준의 현실화
- 너무 엄격한 라벨링(극한 인식)은 오히려 false positive 증가 가능
- 실제 운영 환경을 고려한 적절한 기준 설정 필요

---

## 문제 해결 및 코드 예시

### 히스토그램 평활화 적용 (OpenCV)
```python
import cv2

def enhance_brightness(image, x1, y1, x2, y2):
    """특정 영역에 히스토그램 평활화 적용"""
    enhanced = image.copy()
    
    # 영역 추출
    roi = image[y1:y2, x1:x2]
    
    # BGR -> YUV 변환 (밝기 채널만 조정)
    yuv = cv2.cvtColor(roi, cv2.COLOR_BGR2YUV)
    yuv[:,:,0] = cv2.equalizeHist(yuv[:,:,0])
    
    # YUV -> BGR 역변환
    enhanced_roi = cv2.cvtColor(yuv, cv2.COLOR_YUV2BGR)
    
    # 원본 이미지에 적용
    enhanced[y1:y2, x1:x2] = enhanced_roi
    
    return enhanced

# 사용 예시
frame = cv2.imread('test_frame.jpg')
result = enhance_brightness(frame, 100, 200, 500, 600)
```

---

## 내일 할 일

- 밝기 보정 적용한 새로운 학습 데이터셋 생성 및 학습진행
- 과제 보고서작성