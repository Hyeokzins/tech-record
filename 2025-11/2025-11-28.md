# 2025-11-28 - 일일 기록

## 주요 업무 및 작업
- NAS 자동 백업 스크립트 개발 완료
  - robocopy를 활용한 로컬→NAS 미러링 백업 시스템 구축
  - 연구 데이터, 프로젝트 파일, 문서 등 주요 폴더들 자동 백업 설정
  - 실시간 진행상황 모니터링을 위한 프로그레스바 구현
- sr모듈 wdsr->progessive 모듈 변경 및 ppt 제작
## 배운 점 및 인사이트
- NAS 자동 백업 스크립트
  - robocopy의 미러링 모드(/MIR)를 사용하면 소스와 대상을 완전히 동기화할 수 있음
  - subprocess.Popen으로 외부 프로세스 실행하면서 실시간 출력을 캡처하는 방법 습득
  - robocopy 반환 코드(0-3: 정상, 4+: 오류)를 통한 백업 성공/실패 판단
  - __pycache__, .git 등 불필요한 폴더를 제외하여 백업 효율성 향상
- 기존 decoder에서 body 부분의 resblock16 개를 분리해서 학습하는 과정을 진행함
## 문제 해결 및 코드 예시

### 코드 예시 1: robocopy 실시간 진행률 모니터링
```python
# robocopy 출력을 실시간으로 읽으면서 프로그레스바 업데이트
process = subprocess.Popen(
    cmd,
    stdout=subprocess.PIPE,
    stderr=subprocess.PIPE,
    text=True,
    encoding='cp949',
    bufsize=1  # 라인 버퍼링
)

for line in process.stdout:
    # 파일 복사 관련 키워드 감지
    if any(keyword in line for keyword in ['새 파일', 'New File', '최신', 'Newer']):
        copied_count += 1
        pbar.update(1)
```

### 코드 예시 2: 제외 조건을 적용한 파일 카운팅
```python
def count_files(directory, exclude_dirs, exclude_files):
    count = 0
    for root, dirs, files in os.walk(directory):
        # 제외 디렉토리 필터링
        dirs[:] = [d for d in dirs if d not in exclude_dirs]
        
        # 제외 파일 패턴 체크
        for file in files:
            should_exclude = any(
                file.endswith(pattern[1:]) if pattern.startswith('*.') 
                else file == pattern 
                for pattern in exclude_files
            )
            if not should_exclude:
                count += 1
    return count
```

## 실제 변환 블록도

<img width="1200" height="675" alt="image" src="https://github.com/user-attachments/assets/009cdb81-1bfa-4bb8-8b4c-fe12cacce52e" />

